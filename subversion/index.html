<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>subversion</title>

<link rel="stylesheet" href="../style.css" type="text/css" />

<link rel="stylesheet" href="../local.css" type="text/css" />






</head>
<body>

<div class="page">

<div class="pageheader">
<div class="header">
<span>
<span class="parentlinks">

<a href="../">wiki</a>/ 

</span>
<span class="title">
subversion

</span>
</span>

</div>







</div>



<div id="pagebody">

<div id="content">
<h1>Repository migrating</h1>

<p>Dumping a repository including all revisions:</p>

<pre><code>svnadmin dump /path/to/repository &gt; repository.dump
</code></pre>

<p>Load a dumpfile into a repository:</p>

<pre><code>svnadmin load /path/to/repository &lt; repository.dump
</code></pre>

<p>Filtering a dumpfile can be done with svndumpfilter. For example, to keep only everything inside the 'wiki' directory:</p>

<pre><code>svndumpfilter include wiki --drop-empty-revs --renumber-revs &lt; repository.dump &gt; wiki.dump
</code></pre>

<p>We can edit this dump file to get rid of the 'wiki' parent directory. To just rename 'wiki' to 'trunk':</p>

<pre><code>Node-path: wiki*           -&gt;  Node-path: trunk*
Node-copyfrom-path: wiki*  -&gt;  Node-copyfrom-path: trunk*
</code></pre>

<p>Potential issue is that nodes copied from outside the 'wiki' directory don't have their content in the dump file, rendering the dump useless. Try <a href="http://www.tartarus.org/~simon-anonsvn/viewcvs.cgi/svn-tools/svndumpfilter2?view=markup">svndumpfilter2</a>.</p>

<p>We could also just drop the 'wiki' prefix from all paths. Rename Node-path and Node-copyfrom-path values appropriately as like above, and remove the initial creation of the 'wiki' directory. The entry in the dumpfile will look like this:</p>

<pre><code>Node-path: wiki
Node-action: add
Node-kind: dir
Content-length: 0
</code></pre>

<p>From <a href="http://svnbook.red-bean.com/en/1.2/svn.reposadmin.maint.html#svn.reposadmin.maint.tk.svndumpfilter">Version Control with Subversion: Repository Maintenance</a></p>

<h1>Automated backups</h1>

<p>Make daily, weekly and monthly backups on the repository server with <a href="http://svn.vermaat.name/conf/home/dreamhost-vermaatsvn/bin/svn-backup">an svnadmin dump script</a>.</p>

<p>On other hosts, <a href="http://svn.vermaat.name/conf/home/priscilla/bin/copy-svn-backup">use rsync</a> to sync an offline backup with the latest daily backup on the repository server.</p>

</div>





</div>

<div id="footer" class="pagefooter">

<div id="pageinfo">






<div id="backlinks">
Links:

<a href="../">index</a>


</div>






<div class="pagedate">
Last edited <span class="date">Sat 25 Aug 2012 05:19:51 PM CEST</span>
<!-- Created <span class="date">Sat 25 Aug 2012 05:19:51 PM CEST</span> -->
</div>

</div>


<!-- from wiki -->
</div>

</div>

</body>
</html>
